package dep.mocktool.hmb.hmbclient;

import dep.gateway.hmb8583.HmbMessageFactory;
import dep.mocktool.cbs.MockXSocketBlockClient;
import dep.util.PropertyManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import java.io.IOException;
import java.net.Socket;

public class HmbClient implements Runnable {
    private static final Logger log = LoggerFactory.getLogger(HmbClient.class);
    private static HmbMessageFactory mfact;

    private Socket sock;
    private boolean done = false;

    //private ApplicationContext context;
    protected static String SEND_SYS_ID = PropertyManager.getProperty("SEND_SYS_ID");
    protected static String ORIG_SYS_ID = PropertyManager.getProperty("ORIG_SYS_ID");
    private static ClassPathXmlApplicationContext context;


    public HmbClient(Socket socket) {
        sock = socket;
    }

    public void run() {
        byte[] lenbuf = new byte[7];
        try {
            while (sock != null && sock.isConnected() && !sock.isClosed()) {
                if (sock.getInputStream().read(lenbuf) == 7) {
                    int size = new Integer(new String(lenbuf)) + 4;
                    byte[] buf = new byte[size];
                    sock.getInputStream().read(buf);
                    log.info("HMB Client 接收响应:" + new String(buf));

                    sock.close();

                } else {
                    return;
                }
            }
        } catch (Exception e) {
            log.error("通讯异常:", e);
        } finally {
            if (sock != null) {
                try {
                    sock.close();
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
        }

    }

    protected void stop() {
        done = true;
        try {
            sock.close();
        } catch (IOException ex) {
            log.error("socket err");
        }
        sock = null;
    }

    private static void processByNormalSocket() throws Exception {
        //context = new ClassPathXmlApplicationContext("hmb-context.xml");

        Socket sock = new Socket("localhost", 41014);
        HmbClient client = new HmbClient(sock);
        Thread reader = new Thread(client, "hmb-client1");
        reader.start();

        //byte[] txnbuf = "00005495140FE1D8080000000000000000000000001500003181202290009995140001220020014201203092111271#1113491010629869423001381019F9E04000001021461083DC0000150103331050629869423009102000999011裕环路195号017市北区裕环路195号0110574.7101312320000229226351101#1#15100000000000006010030青岛市棚户区改造开发建设指挥部100010010001001010101010101001001081019F9E04000001021461083DC0000050103331050629872726021102000999XXX001001010001#025市北区裕环路195号1单元1010110574.710131232000022925935701232000022922635111510000000000000601#001#11001001#0030|001#10113XXX1131011#01#010".getBytes();
        //byte[] txnbuf = ((HmbClientService)context.getBean("hmbClientService")).getTxnbuf_5210();

        //5110
//        byte[] txnbuf = ((HmbClientService)context.getBean("hmbClientService")).getTxnbuf("5110", "120314000101511000");

        //5210  1+1
//        byte[] txnbuf = ((HmbClientService) context.getBean("hmbClientService")).getTxnbuf("5210", "120804161286521000");

        //5210 1+7200
//        byte[] txnbuf = ((HmbClientService) context.getBean("hmbClientService")).getTxnbuf("5210", "120314000001521000");

        //5120 国土局提供
//        byte[] txnbuf = "00003245120FE1D8080000000000000000000000001500003181203150048295120001120020014201203150903201#11134212107139449423001281019F9E04000001021461083DC00000501033310507139449423009101004763014青岛测试项目11014青岛测试项目1101001001212320001325026351101#1#15100000000000003010028和记黄埔地产（青岛）有限公司1000100100010010101010101010010010".getBytes();


        //5140
        byte[] txnbuf = "00168165140FE1D80800000000000000000000000015000031812022900469151400027120020014201208091742491#11134910107133832523001781019F9E04000001021461083DC00001501033310507133832523009106004690018开发区石雀滩路75号024黄岛区开发区石雀滩路75号0270076936.2801712320001268857351101#1#2037101986106051016701010022青岛广顺房地产有限公司100010010001001010101010101001001081019F9E04000001021461083DC00001501033310507133832626021106004690003002004010001#029开发区石雀滩路75号3栋2单元4010110586.83017123200012688583570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131234011#01#01081019F9E04000001021461083DC00001501033310507133832726021106004690003002004020001#029开发区石雀滩路75号3栋2单元4020110585.01017123200012688593570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131234021#01#01081019F9E04000001021461083DC00001501033310507133832826021106004690003002002010001#029开发区石雀滩路75号3栋2单元2010110586.83017123200012688603570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131232011#01#01081019F9E04000001021461083DC00001501033310507133832926021106004690003002005010001#029开发区石雀滩路75号3栋2单元50101106119.68017123200012688613570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131235011#01#01081019F9E04000001021461083DC00001501033310507133833026021106004690002001001010001#029开发区石雀滩路75号2栋1单元10101106125.45017123200012688623570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121131011#01#01081019F9E04000001021461083DC00001501033310507133833126021106004690002001001020001#029开发区石雀滩路75号2栋1单元10201106124.43017123200012688633570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121131021#01#01081019F9E04000001021461083DC00001501033310507133833226021106004690002001005020001#029开发区石雀滩路75号2栋1单元50201106167.33017123200012688643570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121135021#01#01081019F9E04000001021461083DC00001501033310507133833326021106004690002001005010001#029开发区石雀滩路75号2栋1单元50101106181.16017123200012688653570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121135011#01#01081019F9E04000001021461083DC00001501033310507133833426021106004690002001002020001#029开发区石雀滩路75号2栋1单元20201106124.43017123200012688663570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121132021#01#01081019F9E04000001021461083DC00001501033310507133833526021106004690002002005020001#029开发区石雀滩路75号2栋2单元50201105113.1017123200012688673570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121235021#01#01081019F9E04000001021461083DC00001501033310507133833626021106004690002002002020001#029开发区石雀滩路75号2栋2单元2020110585.92017123200012688683570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121232021#01#01081019F9E04000001021461083DC00001501033310507133833726021106004690002002002010001#029开发区石雀滩路75号2栋2单元2010110582.75017123200012688693570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121232011#01#01081019F9E04000001021461083DC00001501033310507133833826021106004690001001003010001#029开发区石雀滩路75号1栋1单元3010110588.73017123200012688703570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111133011#01#01081019F9E04000001021461083DC00001501033310507133833926021106004690001001003020001#029开发区石雀滩路75号1栋1单元3020110585.46017123200012688713570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111133021#01#01081019F9E04000001021461083DC00001501033310507133834026021106004690001001001010001#029开发区石雀滩路75号1栋1单元1010110586.91017123200012688723570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111131011#01#01081019F9E04000001021461083DC00001501033310507133834126021106004690001001002020001#029开发区石雀滩路75号1栋1单元2020110585.46017123200012688733570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111132021#01#01081019F9E04000001021461083DC00001501033310507133834226021106004690001001002010001#029开发区石雀滩路75号1栋1单元2010110588.73017123200012688743570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111132011#01#01081019F9E04000001021461083DC00001501033310507133834326021106004690001001005010001#029开发区石雀滩路75号1栋1单元50101106131.69017123200012688753570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111135011#01#01081019F9E04000001021461083DC00001501033310507133834426021106004690003003001020001#029开发区石雀滩路75号3栋3单元1020110586.44017123200012688763570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131331021#01#01081019F9E04000001021461083DC00001501033310507133834526021106004690003003004010001#029开发区石雀滩路75号3栋3单元4010110586.83017123200012688773570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131334011#01#01081019F9E04000001021461083DC00001501033310507133834626021106004690003003001010001#029开发区石雀滩路75号3栋3单元1010110586.83017123200012688783570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131331011#01#01081019F9E04000001021461083DC00001501033310507133834726021106004690003003004020001#029开发区石雀滩路75号3栋3单元4020110588.26017123200012688793570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131334021#01#01081019F9E04000001021461083DC00001501033310507133834826021106004690003003003010001#029开发区石雀滩路75号3栋3单元3010110586.83017123200012688803570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131333011#01#01081019F9E04000001021461083DC00001501033310507133834926021106004690003003002010001#029开发区石雀滩路75号3栋3单元2010110586.83017123200012688813570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131332011#01#01081019F9E04000001021461083DC00001501033310507133835026021106004690003003005020001#029开发区石雀滩路75号3栋3单元50201106130.99017123200012688823570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131335021#01#01081019F9E04000001021461083DC00001501033310507133835126021106004690003001004010001#029开发区石雀滩路75号3栋1单元4010110588.26017123200012688833570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131134011#01#01081019F9E04000001021461083DC00001501033310507133835226021106004690003001005020001#029开发区石雀滩路75号3栋1单元50201106116.38017123200012688843570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131135021#01#01081019F9E04000001021461083DC00001501033310507133835326021106004690003001003010001#029开发区石雀滩路75号3栋1单元3010110588.26017123200012688853570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131133011#01#01081019F9E04000001021461083DC00001501033310507133835426021106004690001002005010001#029开发区石雀滩路75号1栋2单元50101106117.01017123200012688863570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111235011#01#01081019F9E04000001021461083DC00001501033310507133835526021106004690001002003010001#029开发区石雀滩路75号1栋2单元3010110585.46017123200012688873570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111233011#01#01081019F9E04000001021461083DC00001501033310507133835626021106004690001002001020001#029开发区石雀滩路75号1栋2单元1020110586.91017123200012688883570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111231021#01#01081019F9E04000001021461083DC00001501033310507133835726021106004690001002001010001#029开发区石雀滩路75号1栋2单元1010110585.46017123200012688893570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111231011#01#01081019F9E04000001021461083DC00001501033310507133835826021106004690001002004020001#029开发区石雀滩路75号1栋2单元4020110588.73017123200012688903570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111234021#01#01081019F9E04000001021461083DC00001501033310507133835926021106004690001002003020001#029开发区石雀滩路75号1栋2单元3020110588.73017123200012688913570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111233021#01#01081019F9E04000001021461083DC00001501033310507133836026021106004690003002001020001#029开发区石雀滩路75号3栋2单元1020110585.01017123200012688923570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131231021#01#01081019F9E04000001021461083DC00001501033310507133836126021106004690003002005020001#029开发区石雀滩路75号3栋2单元50201106116.38017123200012688933570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131235021#01#01081019F9E04000001021461083DC00001501033310507133836226021106004690002001003020001#029开发区石雀滩路75号2栋1单元30201106124.43017123200012688943570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121133021#01#01081019F9E04000001021461083DC00001501033310507133836326021106004690002001003010001#029开发区石雀滩路75号2栋1单元30101106127.22017123200012688953570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121133011#01#01081019F9E04000001021461083DC00001501033310507133836426021106004690002002001010001#029开发区石雀滩路75号2栋2单元1010110582.75017123200012688963570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121231011#01#01081019F9E04000001021461083DC00001501033310507133836526021106004690003003003020001#029开发区石雀滩路75号3栋3单元3020110588.26017123200012688973570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131333021#01#01081019F9E04000001021461083DC00001501033310507133836626021106004690003001001010001#029开发区石雀滩路75号3栋1单元1010110586.44017123200012688983570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131131011#01#01081019F9E04000001021461083DC00001501033310507133836726021106004690003001003020001#029开发区石雀滩路75号3栋1单元3020110585.01017123200012688993570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131133021#01#01081019F9E04000001021461083DC00001501033310507133836826021106004690003002001010001#029开发区石雀滩路75号3栋2单元1010110586.83017123200012689003570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131231011#01#01081019F9E04000001021461083DC00001501033310507133836926021106004690003002003010001#029开发区石雀滩路75号3栋2单元3010110586.83017123200012689013570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131233011#01#01081019F9E04000001021461083DC00001501033310507133837026021106004690002001004010001#029开发区石雀滩路75号2栋1单元40101106127.22017123200012689023570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121134011#01#01081019F9E04000001021461083DC00001501033310507133837126021106004690002001002010001#029开发区石雀滩路75号2栋1单元20101106127.22017123200012689033570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121132011#01#01081019F9E04000001021461083DC00001501033310507133837226021106004690002002003010001#029开发区石雀滩路75号2栋2单元3010110582.75017123200012689043570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121233011#01#01081019F9E04000001021461083DC00001501033310507133837326021106004690002002004020001#029开发区石雀滩路75号2栋2单元4020110585.92017123200012689053570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121234021#01#01081019F9E04000001021461083DC00001501033310507133837426021106004690001001001020001#029开发区石雀滩路75号1栋1单元1020110585.46017123200012689063570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111131021#01#01081019F9E04000001021461083DC00001501033310507133837526021106004690003001002020001#029开发区石雀滩路75号3栋1单元2020110585.01017123200012689073570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131132021#01#01081019F9E04000001021461083DC00001501033310507133837626021106004690003001002010001#029开发区石雀滩路75号3栋1单元2010110588.26017123200012689083570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131132011#01#01081019F9E04000001021461083DC00001501033310507133837726021106004690003001005010001#029开发区石雀滩路75号3栋1单元50101106130.99017123200012689093570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131135011#01#01081019F9E04000001021461083DC00001501033310507133837826021106004690002002005010001#029开发区石雀滩路75号2栋2单元50101106113.29017123200012689103570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121235011#01#01081019F9E04000001021461083DC00001501033310507133837926021106004690002002001020001#029开发区石雀滩路75号2栋2单元1020110584.15017123200012689113570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121231021#01#01081019F9E04000001021461083DC00001501033310507133838026021106004690001001004010001#029开发区石雀滩路75号1栋1单元4010110588.73017123200012689123570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111134011#01#01081019F9E04000001021461083DC00001501033310507133838126021106004690001001005020001#029开发区石雀滩路75号1栋1单元50201106117.01017123200012689133570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111135021#01#01081019F9E04000001021461083DC00001501033310507133838226021106004690003003005010001#029开发区石雀滩路75号3栋3单元50101106119.68017123200012689143570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131335011#01#01081019F9E04000001021461083DC00001501033310507133838326021106004690003001001020001#029开发区石雀滩路75号3栋1单元1020110585.01017123200012689153570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131131021#01#01081019F9E04000001021461083DC00001501033310507133838426021106004690001001004020001#029开发区石雀滩路75号1栋1单元4020110585.46017123200012689163570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111134021#01#01081019F9E04000001021461083DC00001501033310507133838526021106004690003003002020001#029开发区石雀滩路75号3栋3单元2020110588.26017123200012689173570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131332021#01#01081019F9E04000001021461083DC00001501033310507133838626021106004690003001004020001#029开发区石雀滩路75号3栋1单元4020110585.01017123200012689183570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131134021#01#01081019F9E04000001021461083DC00001501033310507133838726021106004690001002002020001#029开发区石雀滩路75号1栋2单元2020110588.73017123200012689193570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111232021#01#01081019F9E04000001021461083DC00001501033310507133838826021106004690001002005020001#029开发区石雀滩路75号1栋2单元50201106116.81017123200012689203570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111235021#01#01081019F9E04000001021461083DC00001501033310507133838926021106004690003002003020001#029开发区石雀滩路75号3栋2单元3020110585.01017123200012689213570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131233021#01#01081019F9E04000001021461083DC00001501033310507133839026021106004690003002002020001#029开发区石雀滩路75号3栋2单元2020110585.01017123200012689223570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131232021#01#01081019F9E04000001021461083DC00001501033310507133839126021106004690002001004020001#029开发区石雀滩路75号2栋1单元40201106124.43017123200012689233570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121134021#01#01081019F9E04000001021461083DC00001501033310507133839226021106004690002002003020001#029开发区石雀滩路75号2栋2单元3020110585.92017123200012689243570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121233021#01#01081019F9E04000001021461083DC00001501033310507133839326021106004690002002004010001#029开发区石雀滩路75号2栋2单元4010110582.75017123200012689253570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121234011#01#01081019F9E04000001021461083DC00001501033310507133839426021106004690001002004010001#029开发区石雀滩路75号1栋2单元4010110585.46017123200012689263570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111234011#01#01081019F9E04000001021461083DC00000501033310507133839526021106004690001002002010001#029开发区石雀滩路75号1栋2单元2010110585.46017123200012689273570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111232011#01#010".getBytes();

        String txnmsg = new String(txnbuf);
        log.info("发送报文:" + txnmsg);
        sock.getOutputStream().write(txnbuf);
        log.info("等待响应中...");

        while (!sock.isClosed() && sock.isConnected()) {
            Thread.sleep(300);
        }
        client.stop();
        reader.interrupt();
        log.info("DONE...");
    }


    //使用xsocket发送
    private static void processByXsocket() {
        MockXSocketBlockClient socketBlockClient = null;
        try {
            socketBlockClient = new MockXSocketBlockClient("127.0.0.1", 41014, 60000);
            String txnbuf = "00168165140FE1D80800000000000000000000000015000031812022900469151400027120020014201208091742491#11134910107133832523001781019F9E04000001021461083DC00001501033310507133832523009106004690018开发区石雀滩路75号024黄岛区开发区石雀滩路75号0270076936.2801712320001268857351101#1#2037101986106051016701010022青岛广顺房地产有限公司100010010001001010101010101001001081019F9E04000001021461083DC00001501033310507133832626021106004690003002004010001#029开发区石雀滩路75号3栋2单元4010110586.83017123200012688583570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131234011#01#01081019F9E04000001021461083DC00001501033310507133832726021106004690003002004020001#029开发区石雀滩路75号3栋2单元4020110585.01017123200012688593570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131234021#01#01081019F9E04000001021461083DC00001501033310507133832826021106004690003002002010001#029开发区石雀滩路75号3栋2单元2010110586.83017123200012688603570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131232011#01#01081019F9E04000001021461083DC00001501033310507133832926021106004690003002005010001#029开发区石雀滩路75号3栋2单元50101106119.68017123200012688613570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131235011#01#01081019F9E04000001021461083DC00001501033310507133833026021106004690002001001010001#029开发区石雀滩路75号2栋1单元10101106125.45017123200012688623570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121131011#01#01081019F9E04000001021461083DC00001501033310507133833126021106004690002001001020001#029开发区石雀滩路75号2栋1单元10201106124.43017123200012688633570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121131021#01#01081019F9E04000001021461083DC00001501033310507133833226021106004690002001005020001#029开发区石雀滩路75号2栋1单元50201106167.33017123200012688643570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121135021#01#01081019F9E04000001021461083DC00001501033310507133833326021106004690002001005010001#029开发区石雀滩路75号2栋1单元50101106181.16017123200012688653570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121135011#01#01081019F9E04000001021461083DC00001501033310507133833426021106004690002001002020001#029开发区石雀滩路75号2栋1单元20201106124.43017123200012688663570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121132021#01#01081019F9E04000001021461083DC00001501033310507133833526021106004690002002005020001#029开发区石雀滩路75号2栋2单元50201105113.1017123200012688673570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121235021#01#01081019F9E04000001021461083DC00001501033310507133833626021106004690002002002020001#029开发区石雀滩路75号2栋2单元2020110585.92017123200012688683570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121232021#01#01081019F9E04000001021461083DC00001501033310507133833726021106004690002002002010001#029开发区石雀滩路75号2栋2单元2010110582.75017123200012688693570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121232011#01#01081019F9E04000001021461083DC00001501033310507133833826021106004690001001003010001#029开发区石雀滩路75号1栋1单元3010110588.73017123200012688703570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111133011#01#01081019F9E04000001021461083DC00001501033310507133833926021106004690001001003020001#029开发区石雀滩路75号1栋1单元3020110585.46017123200012688713570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111133021#01#01081019F9E04000001021461083DC00001501033310507133834026021106004690001001001010001#029开发区石雀滩路75号1栋1单元1010110586.91017123200012688723570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111131011#01#01081019F9E04000001021461083DC00001501033310507133834126021106004690001001002020001#029开发区石雀滩路75号1栋1单元2020110585.46017123200012688733570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111132021#01#01081019F9E04000001021461083DC00001501033310507133834226021106004690001001002010001#029开发区石雀滩路75号1栋1单元2010110588.73017123200012688743570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111132011#01#01081019F9E04000001021461083DC00001501033310507133834326021106004690001001005010001#029开发区石雀滩路75号1栋1单元50101106131.69017123200012688753570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111135011#01#01081019F9E04000001021461083DC00001501033310507133834426021106004690003003001020001#029开发区石雀滩路75号3栋3单元1020110586.44017123200012688763570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131331021#01#01081019F9E04000001021461083DC00001501033310507133834526021106004690003003004010001#029开发区石雀滩路75号3栋3单元4010110586.83017123200012688773570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131334011#01#01081019F9E04000001021461083DC00001501033310507133834626021106004690003003001010001#029开发区石雀滩路75号3栋3单元1010110586.83017123200012688783570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131331011#01#01081019F9E04000001021461083DC00001501033310507133834726021106004690003003004020001#029开发区石雀滩路75号3栋3单元4020110588.26017123200012688793570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131334021#01#01081019F9E04000001021461083DC00001501033310507133834826021106004690003003003010001#029开发区石雀滩路75号3栋3单元3010110586.83017123200012688803570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131333011#01#01081019F9E04000001021461083DC00001501033310507133834926021106004690003003002010001#029开发区石雀滩路75号3栋3单元2010110586.83017123200012688813570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131332011#01#01081019F9E04000001021461083DC00001501033310507133835026021106004690003003005020001#029开发区石雀滩路75号3栋3单元50201106130.99017123200012688823570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131335021#01#01081019F9E04000001021461083DC00001501033310507133835126021106004690003001004010001#029开发区石雀滩路75号3栋1单元4010110588.26017123200012688833570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131134011#01#01081019F9E04000001021461083DC00001501033310507133835226021106004690003001005020001#029开发区石雀滩路75号3栋1单元50201106116.38017123200012688843570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131135021#01#01081019F9E04000001021461083DC00001501033310507133835326021106004690003001003010001#029开发区石雀滩路75号3栋1单元3010110588.26017123200012688853570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131133011#01#01081019F9E04000001021461083DC00001501033310507133835426021106004690001002005010001#029开发区石雀滩路75号1栋2单元50101106117.01017123200012688863570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111235011#01#01081019F9E04000001021461083DC00001501033310507133835526021106004690001002003010001#029开发区石雀滩路75号1栋2单元3010110585.46017123200012688873570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111233011#01#01081019F9E04000001021461083DC00001501033310507133835626021106004690001002001020001#029开发区石雀滩路75号1栋2单元1020110586.91017123200012688883570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111231021#01#01081019F9E04000001021461083DC00001501033310507133835726021106004690001002001010001#029开发区石雀滩路75号1栋2单元1010110585.46017123200012688893570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111231011#01#01081019F9E04000001021461083DC00001501033310507133835826021106004690001002004020001#029开发区石雀滩路75号1栋2单元4020110588.73017123200012688903570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111234021#01#01081019F9E04000001021461083DC00001501033310507133835926021106004690001002003020001#029开发区石雀滩路75号1栋2单元3020110588.73017123200012688913570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111233021#01#01081019F9E04000001021461083DC00001501033310507133836026021106004690003002001020001#029开发区石雀滩路75号3栋2单元1020110585.01017123200012688923570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131231021#01#01081019F9E04000001021461083DC00001501033310507133836126021106004690003002005020001#029开发区石雀滩路75号3栋2单元50201106116.38017123200012688933570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131235021#01#01081019F9E04000001021461083DC00001501033310507133836226021106004690002001003020001#029开发区石雀滩路75号2栋1单元30201106124.43017123200012688943570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121133021#01#01081019F9E04000001021461083DC00001501033310507133836326021106004690002001003010001#029开发区石雀滩路75号2栋1单元30101106127.22017123200012688953570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121133011#01#01081019F9E04000001021461083DC00001501033310507133836426021106004690002002001010001#029开发区石雀滩路75号2栋2单元1010110582.75017123200012688963570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121231011#01#01081019F9E04000001021461083DC00001501033310507133836526021106004690003003003020001#029开发区石雀滩路75号3栋3单元3020110588.26017123200012688973570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131333021#01#01081019F9E04000001021461083DC00001501033310507133836626021106004690003001001010001#029开发区石雀滩路75号3栋1单元1010110586.44017123200012688983570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131131011#01#01081019F9E04000001021461083DC00001501033310507133836726021106004690003001003020001#029开发区石雀滩路75号3栋1单元3020110585.01017123200012688993570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131133021#01#01081019F9E04000001021461083DC00001501033310507133836826021106004690003002001010001#029开发区石雀滩路75号3栋2单元1010110586.83017123200012689003570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131231011#01#01081019F9E04000001021461083DC00001501033310507133836926021106004690003002003010001#029开发区石雀滩路75号3栋2单元3010110586.83017123200012689013570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131233011#01#01081019F9E04000001021461083DC00001501033310507133837026021106004690002001004010001#029开发区石雀滩路75号2栋1单元40101106127.22017123200012689023570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121134011#01#01081019F9E04000001021461083DC00001501033310507133837126021106004690002001002010001#029开发区石雀滩路75号2栋1单元20101106127.22017123200012689033570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121132011#01#01081019F9E04000001021461083DC00001501033310507133837226021106004690002002003010001#029开发区石雀滩路75号2栋2单元3010110582.75017123200012689043570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121233011#01#01081019F9E04000001021461083DC00001501033310507133837326021106004690002002004020001#029开发区石雀滩路75号2栋2单元4020110585.92017123200012689053570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121234021#01#01081019F9E04000001021461083DC00001501033310507133837426021106004690001001001020001#029开发区石雀滩路75号1栋1单元1020110585.46017123200012689063570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111111131021#01#01081019F9E04000001021461083DC00001501033310507133837526021106004690003001002020001#029开发区石雀滩路75号3栋1单元2020110585.01017123200012689073570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131132021#01#01081019F9E04000001021461083DC00001501033310507133837626021106004690003001002010001#029开发区石雀滩路75号3栋1单元2010110588.26017123200012689083570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131132011#01#01081019F9E04000001021461083DC00001501033310507133837726021106004690003001005010001#029开发区石雀滩路75号3栋1单元50101106130.99017123200012689093570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131135011#01#01081019F9E04000001021461083DC00001501033310507133837826021106004690002002005010001#029开发区石雀滩路75号2栋2单元50101106113.29017123200012689103570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121235011#01#01081019F9E04000001021461083DC00001501033310507133837926021106004690002002001020001#029开发区石雀滩路75号2栋2单元1020110584.15017123200012689113570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111121231021#01#01081019F9E04000001021461083DC00001501033310507133838026021106004690001001004010001#029开发区石雀滩路75号1栋1单元4010110588.73017123200012689123570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111134011#01#01081019F9E04000001021461083DC00001501033310507133838126021106004690001001005020001#029开发区石雀滩路75号1栋1单元50201106117.01017123200012689133570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111135021#01#01081019F9E04000001021461083DC00001501033310507133838226021106004690003003005010001#029开发区石雀滩路75号3栋3单元50101106119.68017123200012689143570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131335011#01#01081019F9E04000001021461083DC00001501033310507133838326021106004690003001001020001#029开发区石雀滩路75号3栋1单元1020110585.01017123200012689153570123200012688573511203710198610605101670101#001#11001001#0091020|0.0501#1111131131021#01#01081019F9E04000001021461083DC00001501033310507133838426021106004690001001004020001#029开发区石雀滩路75号1栋1单元4020110585.46017123200012689163570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111134021#01#01081019F9E04000001021461083DC00001501033310507133838526021106004690003003002020001#029开发区石雀滩路75号3栋3单元2020110588.26017123200012689173570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131332021#01#01081019F9E04000001021461083DC00001501033310507133838626021106004690003001004020001#029开发区石雀滩路75号3栋1单元4020110585.01017123200012689183570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131134021#01#01081019F9E04000001021461083DC00001501033310507133838726021106004690001002002020001#029开发区石雀滩路75号1栋2单元2020110588.73017123200012689193570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111232021#01#01081019F9E04000001021461083DC00001501033310507133838826021106004690001002005020001#029开发区石雀滩路75号1栋2单元50201106116.81017123200012689203570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111235021#01#01081019F9E04000001021461083DC00001501033310507133838926021106004690003002003020001#029开发区石雀滩路75号3栋2单元3020110585.01017123200012689213570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131233021#01#01081019F9E04000001021461083DC00001501033310507133839026021106004690003002002020001#029开发区石雀滩路75号3栋2单元2020110585.01017123200012689223570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111131232021#01#01081019F9E04000001021461083DC00001501033310507133839126021106004690002001004020001#029开发区石雀滩路75号2栋1单元40201106124.43017123200012689233570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121134021#01#01081019F9E04000001021461083DC00001501033310507133839226021106004690002002003020001#029开发区石雀滩路75号2栋2单元3020110585.92017123200012689243570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121233021#01#01081019F9E04000001021461083DC00001501033310507133839326021106004690002002004010001#029开发区石雀滩路75号2栋2单元4010110582.75017123200012689253570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111121234011#01#01081019F9E04000001021461083DC00001501033310507133839426021106004690001002004010001#029开发区石雀滩路75号1栋2单元4010110585.46017123200012689263570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111234011#01#01081019F9E04000001021461083DC00000501033310507133839526021106004690001002002010001#029开发区石雀滩路75号1栋2单元2010110585.46017123200012689273570123200012688573511203710198610605101670101#001#11001001#0091670|0.0801#1111111232011#01#010";
            socketBlockClient.sendDataUntilRcvToDep(txnbuf.getBytes());
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                socketBlockClient.close();
            } catch (Exception e) {
                e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
            }
        }
    }


    public static void main(String[] args) throws Exception {
          processByNormalSocket();
//        processByXsocket();
        System.out.println("Done.");
    }

}
